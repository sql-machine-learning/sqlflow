apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: pytest-
spec:
  entrypoint: pytest
  templates:
    - name: pytest
      steps:
        - - name: train-50
            template: train
            arguments:
              parameters:
                - name: para-train-0
                  value: -m
                - name: para-train-1
                  value: xgboost_step.train
                - name: para-train-2
                  value: --datasource
                - name: para-train-3
                  value: mysql://root:root@tcp(127.0.0.1:3306)/?maxAllowedPacket=0
                - name: para-train-4
                  value: --train-select
                - name: para-train-5
                  value: 'SELECT * FROM iris.train'
                - name: para-train-6
                  value: --validate-select
                - name: para-train-7
                  value: 'SELECT * FROM iris.test'
                - name: para-train-8
                  value: --model-params
                - name: para-train-9
                  value: '{"objective": "reg:squarederror"}'
                - name: para-train-10
                  value: --train-params
                - name: para-train-11
                  value: '{"num_boost_round": 30}'
                - name: para-train-12
                  value: --feature-field-meta
                - name: para-train-13
                  value: '[{"name": "sepal_length", "dtype": "float", "is_sparse":
                    false, "delimiter": "", "shape": [1]}, {"name": "sepal_width",
                    "dtype": "float", "is_sparse": false, "delimiter": "", "shape":
                    [1]}, {"name": "petal_length", "dtype": "float", "is_sparse":
                    false, "delimiter": "", "shape": [1]}, {"name": "petal_width",
                    "dtype": "float", "is_sparse": false, "delimiter": "", "shape":
                    [1]}]'
                - name: para-train-14
                  value: --label-field-meta
                - name: para-train-15
                  value: '{"name": "class", "dtype": "int32", "is_sparse": false,
                    "delimiter": "", "shape": [1]}'
    - name: train
      inputs:
        parameters:
          - name: para-train-0
          - name: para-train-1
          - name: para-train-2
          - name: para-train-3
          - name: para-train-4
          - name: para-train-5
          - name: para-train-6
          - name: para-train-7
          - name: para-train-8
          - name: para-train-9
          - name: para-train-10
          - name: para-train-11
          - name: para-train-12
          - name: para-train-13
          - name: para-train-14
          - name: para-train-15
      container:
        image: couler/xgboost_step:0.90
        command:
          - bash
          - -c
          - python
        args:
          - "{{inputs.parameters.para-train-0}}"
          - "{{inputs.parameters.para-train-1}}"
          - "{{inputs.parameters.para-train-2}}"
          - "{{inputs.parameters.para-train-3}}"
          - "{{inputs.parameters.para-train-4}}"
          - "{{inputs.parameters.para-train-5}}"
          - "{{inputs.parameters.para-train-6}}"
          - "{{inputs.parameters.para-train-7}}"
          - "{{inputs.parameters.para-train-8}}"
          - "{{inputs.parameters.para-train-9}}"
          - "{{inputs.parameters.para-train-10}}"
          - "{{inputs.parameters.para-train-11}}"
          - "{{inputs.parameters.para-train-12}}"
          - "{{inputs.parameters.para-train-13}}"
          - "{{inputs.parameters.para-train-14}}"
          - "{{inputs.parameters.para-train-15}}"
