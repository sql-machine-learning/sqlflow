apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: pytest-
spec:
  entrypoint: pytest
  templates:
    - name: pytest
      steps:
        - - name: run-query-13
            template: run-query
            arguments:
              parameters:
                - name: para-run-query-0
                  value: sre_mpi_algo_dev
                - name: para-run-query-1
                  value: mock_access_id
                - name: para-run-query-2
                  value: mock_access_key
                - name: para-run-query-3
                  value: http://service-corp.odps.aliyun-inc.com/api
    - name: run-query
      inputs:
        parameters:
          - name: para-run-query-0
          - name: para-run-query-1
          - name: para-run-query-2
          - name: para-run-query-3
      container:
        image: reg.docker.alibaba-inc.com/couler/odps:0.31.0
        command:
          - bash
          - -c
          - 'odpscmd --project=sre_mpi_algo_dev --endpoint=http://service-corp.odps.aliyun-inc.com/api
            -u mock_access_id -p mock_access_key -e "select * from dual limit 1"'
        args:
          - "{{inputs.parameters.para-run-query-0}}"
          - "{{inputs.parameters.para-run-query-1}}"
          - "{{inputs.parameters.para-run-query-2}}"
          - "{{inputs.parameters.para-run-query-3}}"
        resources:
          limits:
            cpu: 1
            memory: 1000Mi
            ephemeral-storage: 1Gi
          requests:
            cpu: 1
            memory: 1000Mi
            ephemeral-storage: 1Gi

